maintainer="Mitchell Scott <mitchell@scottlabs.io>"
pkgname=tap-to-change-view-or-page
pkgver=1.0.0
pkgrel=0
upstream_author="ingatellent"
category="ui"
pkgdesc="Tap screen edges to scroll/navigate pages when toolbar is hidden."
url="https://github.com/ingatellent/xovi-qmd-extensions"
arch="noarch"
license="GPL-2.0"
depends="qt-resource-rebuilder scroll-screen-up-or-down remarkable-os>=3.25 remarkable-os<3.26"
replaces="gesture-tap-to-page"
_commit="82f0526a81a46751dd4c16d7c27f754a6afa23ec"
source="
tapToChangeViewOrPage.qmd::https://raw.githubusercontent.com/ingatellent/xovi-qmd-extensions/$_commit/3.25/tapToChangeViewOrPage.qmd
LICENSE::https://raw.githubusercontent.com/ingatellent/xovi-qmd-extensions/$_commit/LICENSE.md
"
options="!check !fhs"

package() {
	install -Dm644 "$srcdir/tapToChangeViewOrPage.qmd" \
		"$pkgdir/home/root/xovi/exthome/qt-resource-rebuilder/ingatellent/tapToChangeViewOrPage.qmd"

	install -Dm644 "$srcdir/LICENSE" \
		"$pkgdir/home/root/.vellum/licenses/$pkgname/LICENSE"
	echo "https://github.com/ingatellent/xovi-qmd-extensions" > \
		"$pkgdir/home/root/.vellum/licenses/$pkgname/SOURCES"
}

postinstall(){
	LOADER="/home/root/xovi/exthome/qt-resource-rebuilder/_ingatellent.qmd"
	QMD_FILE="ingatellent/tapToChangeViewOrPage.qmd"

	touch "$LOADER"

	if ! grep -q "LOAD $QMD_FILE" "$LOADER"; then
	    echo "LOAD $QMD_FILE" >> "$LOADER"
	fi
}

postdeinstall(){
	LOADER="/home/root/xovi/exthome/qt-resource-rebuilder/_ingatellent.qmd"

	if [ -f "$LOADER" ]; then
		QMD_FILE="ingatellent/tapToChangeViewOrPage.qmd"
		sed -i "\|^LOAD $QMD_FILE$|d" "$LOADER"

		if [ ! -s "$LOADER" ]; then
			rm -f "$LOADER"
		fi
	fi
}

sha512sums="
c2ba6ead87d44ed7d04ce82f5d950bbefa5bc88fb57a82e7fa8226d53dcabdf0487ae12715cdb7e4ba391b9477cd6cdad1c158e450cb674b5557d83a73879459  tapToChangeViewOrPage.qmd
aee80b1f9f7f4a8a00dcf6e6ce6c41988dcaedc4de19d9d04460cbfb05d99829ffe8f9d038468eabbfba4d65b38e8dbef5ecf5eb8a1b891d9839cda6c48ee957  LICENSE
"
