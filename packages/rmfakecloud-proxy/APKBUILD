maintainer="Mitchell Scott <mitchell@scottlabs.io>"
pkgname=rmfakecloud-proxy
pkgver=0.0.10
pkgrel=0
pkgdesc="HTTPS proxy for rmfakecloud - redirects reMarkable cloud traffic"
_upstream_author="ddvk"
_category="utilities"
url="https://github.com/ddvk/rmfakecloud-proxy"
arch="aarch64 armv7"
license="MIT"
install="$pkgname.post-install $pkgname.pre-deinstall"
options="!check !fhs !strip !tracedeps"

source="
	installer-rmpro.sh::https://github.com/$_upstream_author/rmfakecloud-proxy/releases/download/v$pkgver/installer-rmpro.sh
	installer-rm12.sh::https://github.com/$_upstream_author/rmfakecloud-proxy/releases/download/v$pkgver/installer-rm12.sh
	LICENSE::https://raw.githubusercontent.com/$_upstream_author/rmfakecloud-proxy/master/LICENSE
"

package() {
	case "$CARCH" in
		aarch64)
			install -Dm755 "$srcdir/installer-rmpro.sh" "$pkgdir/home/root/rmfakecloud/install.sh"
			;;
		armv7)
			install -Dm755 "$srcdir/installer-rm12.sh" "$pkgdir/home/root/rmfakecloud/install.sh"
			;;
	esac

	install -Dm644 "$srcdir/LICENSE" "$pkgdir/home/root/.vellum/licenses/$pkgname/LICENSE"
	echo "https://github.com/$_upstream_author/rmfakecloud-proxy" > "$pkgdir/home/root/.vellum/licenses/$pkgname/SOURCES"

	install -Dm755 "$startdir/$pkgname.post-os-upgrade" \
		"$pkgdir/home/root/.vellum/hooks/post-os-upgrade/$pkgname"
}
sha512sums="
01ba8b26833bfed4be77eae01ba02661d0d42034c55d5593b41841979709bf6d50fc18a7ba67d5058b8b578a4af5e137224033bc0c7c24ab97ed543156d941ea  installer-rmpro.sh
a7b00d5c19c5146df9e77f2a41ec2b0e3fc8a01142942ad13a69f6724c21b3cdb6cfd2ddc36ddb3aafbbec8468ded1c58725758c346d453271e7ffca61b34669  installer-rm12.sh
301894039600f7de8c2dad0be29bc5d0e4f975671a1dd7ce9974731daaa43c83a60f5b7d28bc368423d63e8965f04961800284d0269011a1ae536202ec98ca2e  LICENSE
"
