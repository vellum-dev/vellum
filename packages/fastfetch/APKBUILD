maintainer="notfrants <notfrants@proton.me>"
pkgname=fastfetch
pkgver=2.58.0
pkgrel=0
_upstream_author="fastfetch-cli"
_category="utilities"
pkgdesc="A maintained, feature-rich and performance oriented, neofetch like system information tool."
url="https://github.com/fastfetch-cli/fastfetch"
arch="aarch64 armv7"
license="MIT"
options="!check !fhs !strip !tracedeps"
install="$pkgname.post-deinstall"

source="
$pkgname-$pkgver-linux-aarch64.tar.gz::https://github.com/fastfetch-cli/fastfetch/releases/download/$pkgver/fastfetch-linux-aarch64.tar.gz
$pkgname-$pkgver-linux-armv7l.tar.gz::https://github.com/fastfetch-cli/fastfetch/releases/download/$pkgver/fastfetch-linux-armv7l.tar.gz
"

prepare() {
	default_prepare
	cd "$srcdir"
	case "$CARCH" in
		aarch64) tar --strip-components=1 -xzf "$pkgname-$pkgver-linux-aarch64.tar.gz";;
		armv7|armhf) tar --strip-components=1 -xzf "$pkgname-$pkgver-linux-armv7l.tar.gz" ;;
	esac
}

package() {
	install -Dm755 "$srcdir/usr/bin/fastfetch" "$pkgdir/home/root/.vellum/bin/fastfetch"

	install -Dm644 "$srcdir/usr/share/licenses/$pkgname/LICENSE" \
		"$pkgdir/home/root/.vellum/licenses/$pkgname/LICENSE"
	echo "https://github.com/fastfetch-cli/fastfetch/archive/refs/tags/$pkgver.tar.gz" > \
		"$pkgdir/home/root/.vellum/licenses/$pkgname/SOURCES"
	
	install -d "$pkgdir/home/root/.local/share/$pkgname/presets/examples"
	install -m644 "$srcdir/usr/share/$pkgname/presets/"*.jsonc \
		"$pkgdir/home/root/.local/share/$pkgname/presets/"
	install -m644 "$srcdir/usr/share/$pkgname/presets/examples/"*.jsonc \
		"$pkgdir/home/root/.local/share/$pkgname/presets/examples/"
}
sha512sums="
159387e0c35357880d8b0b6e96429c51a4bf1cd37b5176e4e3e196b36c847cb438e75c41d5840024134eb0db360a28f2bef22d199dd4d4917bee0e394abb4902  fastfetch-2.58.0-linux-aarch64.tar.gz
50b249f498886ba3e7a208227960035a1018630f8114e4583d2dd1a5c029f94acbfe451751e6fc70132bc596b9c0b85a56242c48ebf1fc8d6aab06a43f3ad933  fastfetch-2.58.0-linux-armv7l.tar.gz
"
